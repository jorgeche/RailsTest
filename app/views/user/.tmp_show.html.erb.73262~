<%= javascript_include_tag "encryption", "jquery", "jquerydialog" %>
<%= stylesheet_link_tag "jquerydialogs"%>

<script type="text/javascript">

  	document.observe('dom:loaded', function() {
		showKeyDialog('dialog');
	});
	
	function showUser()
	{
		$('#user_username').attr('innerHTML', AesCtr.decrypt($('#user_username').attr('innerHTML'), $('#encryptionKey').attr('value'), 256));
		$('#user_address').attr('innerHTML', AesCtr.decrypt($('#user_address').attr('innerHTML'), $('#encryptionKey').attr('value'), 256));

		$('#mask, .window').hide();
		return true;
	}

</script>

<body onload="showKeyDialog('dialog');">

<!--<p>
  <b>Id:</b>
  <%=h @user.id %>
</p>
-->
<p>
  <b>Username:</b>
  <%= label_tag @user.username, @user.username, :id => 'user_username' %> <br> <br>
</p>

<p>
  <b>Address:</b>
  <%= label_tag @user.address, @user.address, :id => 'user_address' %> <br> <br>
</p>


<%= link_to 'Edit', edit_user_path(@user) %> |
<%= link_to 'Back', users_path %>

<!-- #dialog is the id of a DIV defined in the code below -->  
<div id="boxes">  
	<!-- #customize your modal window here -->  
	<div id="dialog" class="window">  
		<b>Enter encryption key</b> |   
		
		<!-- close button is defined as close class -->  		
		<br />
		<input id="encryptionKey" type="text" value=""/> 
		<br />
		<input type="button" class="accept" value="Accept" onclick="showUser();"/>
		<input type="button" class="close" value="Cancel"/>  
		
	</div>  	
	
	<!-- Do not remove div#mask, because you'll need it to fill the whole screen -->    
	<div id="mask"></div>  
</div>